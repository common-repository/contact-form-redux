!function(s){"use strict";"undefined"!=typeof cfredux&&null!==cfredux&&(s(function(){var t,a=s("#cfr-welcome-panel");function n(e){var t=e.key||e.keyCode,a=s(".cfractivetab").index(),n=0;switch(t){case 37:case"ArrowLeft":case"<":n=-1;break;case 39:case"ArrowRight":case">":n=1}-1===n?0!==a&&s(".contact-form-editor-tablink").eq(a-1).click():1===n&&a!==s(".contact-form-editor-tablink").last().index()&&s(".contact-form-editor-tablink").eq(a+1).click()}t=function(e){s.post(ajaxurl,{action:"cfredux-update-welcome-panel",visible:e,welcomepanelnonce:s("#welcomepanelnonce").val()})},s("a.cfr-welcome-panel-close",a).click(function(e){e.preventDefault(),a.addClass("hidden"),t(0)}),s("#contact-form-editor-tabs").focusin(function(e){s("#contact-form-editor .keyboard-interaction").css("visibility","visible"),document.addEventListener("keyup",n,!1)}).focusout(function(e){s("#contact-form-editor .keyboard-interaction").css("visibility","hidden"),document.removeEventListener("keyup",n,!1)}),s(".contact-form-editor-tablink").click(function(e){e.preventDefault();var t=s(this).attr("id").replace("-tab","");s(".contact-form-editor-tabcontent").each(function(){s(this).hide()}),s(".contact-form-editor-tablink").each(function(){s(this).removeClass("cfractivetab")}),s("#"+t).show(),s(this).addClass("cfractivetab")}),s(".cfrclose").click(function(){s(this).closest(".cfrmodaldiv").css("display","none")}),s(document).keyup(function(e){27===e.keyCode&&s(".cfrmodaldiv").each(function(){s(this).css("display","none")})}),s(".cfrtagbutton").click(function(){s("#"+s(this).data("tag")).closest(".cfrmodaldiv").css("display","block")}),s(".cfrinfo").click(function(){s(this).closest("p").siblings(".cfrinfopopup").toggle()}),cfredux.toggleMail2('input[type="checkbox"].toggle-form-table'),s("#cfredux-save-cf").click(function(){return this.form._wpnonce.value=s(this).data("nonce"),this.form.action.value="save",!0}),s("#cfredux-copy-cf").click(function(){return this.form._wpnonce.value=s(this).data("nonce"),this.form.action.value="copy",!0}),s("#cfredux-delete-cf").click(function(){return!!confirm(s(this).data("confirm"))&&(this.form._wpnonce.value=s(this).data("nonce"),this.form.action.value="delete",!0)}),s('input[type="text"].code').click(function(){s(this).select()}),s("#cfredux-shortcode").click(function(){s(this).select()}),s('input[type="checkbox"].toggle-form-table').click(function(e){cfredux.toggleMail2(this)}),""===s("#title").val()&&s("#title").focus(),cfredux.titleHint(),s(".contact-form-editor-box-mail span.mailtag").click(function(e){var t=document.createRange();t.selectNodeContents(this),window.getSelection().addRange(t)}),cfredux.updateConfigErrors(),s("[data-config-field]").change(function(){var e=s("#post_ID").val();if(e&&-1!=e){var t=[];s(this).closest("form").find("[data-config-field]").each(function(){t.push({name:s(this).attr("name").replace(/^cfredux-/,"").replace(/-/g,"_"),value:s(this).val()})}),t.push({name:"context",value:"dry-run"}),s.ajax({method:"POST",url:cfredux.apiSettings.getRoute("/contact-forms/"+e),beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",cfredux.apiSettings.nonce)},data:t}).done(function(e){cfredux.configValidator.errors=e.config_errors,cfredux.updateConfigErrors()})}}),s(window).on("beforeunload",function(e){if(document.getElementById("cfredux-admin-form-element")){var t,a=document.getElementById("cfredux-admin-form-element").elements,n=!1;for(t=0;t<a.length;t++)switch(a[t].nodeName.toLowerCase()){case"input":if("hidden"!=a[t].type)switch(a[t].type){case"checkbox":case"radio":a[t].defaultChecked!=a[t].checked&&(n=!0);break;default:a[t].defaultValue!=a[t].value&&(n=!0)}break;case"textarea":a[t].defaultValue!=a[t].value&&(n=!0);break;case"select":!1===a[t].options[a[t].selectedIndex].defaultSelected&&(n=!0);break;default:a[t].defaultValue==a[t].value||a[t].classList.contains("contact-form-editor-tablink")||(n=!0)}}if(n)return e.returnValue=cfredux.saveAlert,cfredux.saveAlert}),s("#cfredux-admin-form-element").submit(function(){"copy"!=this.action.value&&s(window).off("beforeunload"),"save"==this.action.value&&s("#publishing-action .spinner").addClass("is-active")})}),cfredux.toggleMail2=function(e){var t=s(e),a=s("fieldset",t.closest(".contact-form-editor-box-mail"));!0===t.prop("checked")?a.removeClass("hidden"):a.addClass("hidden")},cfredux.updateConfigErrors=function(){var r=cfredux.configValidator.errors,o={total:0};if(s("[data-config-field]").each(function(){s(this).removeAttr("aria-invalid"),s(this).next("ul.config-error").remove();var c=s(this).attr("data-config-field");if(r[c]){var i=s("<ul></ul>").attr({role:"alert",class:"config-error"});s.each(r[c],function(e,t){var a=s("<li></li>").append(s('<span class="dashicons dashicons-warning" aria-hidden="true"></span>')).append(s('<span class="screen-reader-text"></span>').text(cfredux.configValidator.iconAlt)).append(" ");t.link?a.append(s("<a></a>").attr("href",t.link).text(t.message)):a.text(t.message),a.appendTo(i);var n=c.replace(/^mail_\d+\./,"mail.").replace(/\..*$/,"");o[n]||(o[n]=0),o[n]+=1,o.total+=1}),s(this).after(i).attr({"aria-invalid":"true"})}}),s(".contact-form-editor-tablink").each(function(){var e,a=s(this),n=a.attr("id").replace(/-panel-tab$/,""),t=s("#"+n+"-panel > div.config-error").first();a.find("span.dashicons").remove(),s.each(r,function(e,t){if((e=e.replace(/^mail_\d+\./,"mail.")).replace(/\..*$/,"")==n.replace("-","_"))return a.append('<span class="dashicons dashicons-warning" aria-hidden="true"></span>'),!1}),t.empty(),o[n.replace("-","_")]&&(t.append('<span class="dashicons dashicons-warning" aria-hidden="true"></span> '),1<o[n.replace("-","_")]?(e=cfredux.configValidator.manyErrorsInTab.replace("%d",o[n.replace("-","_")]),t.append(e)):t.append(cfredux.configValidator.oneErrorInTab))}),s("#misc-publishing-actions .misc-pub-section.config-error").remove(),o.total){var e=s("<div></div>").addClass("misc-pub-section config-error").append('<span class="dashicons dashicons-warning" aria-hidden="true"></span> ');1<o.total?e.append(cfredux.configValidator.manyErrors.replace("%d",o.total)):e.append(cfredux.configValidator.oneError),e.append("<br />").append(s("<a></a>").attr("href",cfredux.configValidator.docUrl).text(cfredux.configValidator.howToCorrect)),s("#misc-publishing-actions").append(e)}},cfredux.titleHint=function(){var e=s("#title"),t=s("#title-prompt-text");""===e.val()&&t.removeClass("screen-reader-text"),t.click(function(){s(this).addClass("screen-reader-text"),e.focus()}),e.blur(function(){""===s(this).val()&&t.removeClass("screen-reader-text")}).focus(function(){t.addClass("screen-reader-text")}).keydown(function(e){t.addClass("screen-reader-text"),s(this).unbind(e)})},cfredux.apiSettings.getRoute=function(e){var t=cfredux.apiSettings.root;return t=t.replace(cfredux.apiSettings.namespace,cfredux.apiSettings.namespace+e)})}(jQuery);