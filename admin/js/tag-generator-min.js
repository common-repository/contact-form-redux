!function(u){"use strict";"undefined"!=typeof cfredux&&null!==cfredux&&(cfredux.taggen={},u(function(){u("form.tag-generator-panel").each(function(){cfredux.taggen.update(u(this))})}),u("form.tag-generator-panel").submit(function(){return!1}),u("form.tag-generator-panel .control-box input, form.tag-generator-panel .control-box select, form.tag-generator-panel .control-box textarea").change(function(){var e=u(this).closest("form.tag-generator-panel");cfredux.taggen.normalize(u(this)),cfredux.taggen.update(e)}),u("input.insert-tag").click(function(){var e=u(this).closest("form.tag-generator-panel").find("input.tag").val();return cfredux.taggen.insert(e),u(this).closest(".cfrmodaldiv").css("display","none"),!1}),u('.insert-box input[type="text"].tag').click(function(){u(this).select()}),cfredux.taggen.update=function(a){var e=a.attr("data-id"),t="",n=a.find('input[name="name"]');if(n.length&&""===(t=n.val())&&(t=e+"-"+Math.floor(1e3*Math.random()),n.val(t)),u.isFunction(cfredux.taggen.update[e]))return cfredux.taggen.update[e].call(this,a);a.find("input.tag").each(function(){var e=u(this).attr("name");a.find('select[name="tagtype"]').length&&(e=a.find('select[name="tagtype"]').val()),!0===a.find('input[name="required"]').prop("checked")&&(e+="*");var t=cfredux.taggen.compose(e,a);u(this).val(t)}),a.find("span.mail-tag").text("["+t+"]"),a.find("input.mail-tag").each(function(){u(this).val("["+t+"]")})},cfredux.taggen.update.captcha=function(e){var t=cfredux.taggen.compose("captchac",e),a=cfredux.taggen.compose("captchar",e);e.find("input.tag").val(t+" "+a)},cfredux.taggen.compose=function(e,t){var a=t.find('input[name="name"]').val(),n=t.find(".scope."+e);n.length||(n=t);var i=[];n.find("input.option").not('[type="checkbox"], [type="radio"]').each(function(e){var t=u(this).val();t&&(u(this).hasClass("filetype")&&(t=t.split(/[,|\s]+/).join("|")),u(this).hasClass("color")&&(t="#"+t),"class"==u(this).attr("name")?u.each(t.split(" "),function(e,t){i.push("class:"+t)}):i.push(u(this).attr("name")+":"+t))}),n.find("select.option").each(function(e){var t=u(this).attr("name"),a=u(this).val();"compact"!=a&&"dark"!=a||i.push(t+":"+a)}),n.find('input[type="checkbox"].option').each(function(e){!0===u(this).prop("checked")&&i.push(u(this).attr("name"))}),n.find('input[type="radio"].option').each(function(e){!0!==u(this).prop("checked")||u(this).hasClass("default")||i.push(u(this).attr("name")+":"+u(this).val())}),"radio"==e&&i.push("default:1"),i=0<i.length?i.join(" "):"";var c="",s=n.find('input[name="values"], textarea[name="values"]').val();s&&u.each(s.split("\n"),function(e,t){c+=' "'+t.replace(/["]/g,"&quot;")+'"'});var r=[];u.each([e,a,i,c],function(e,t){""!=(t=u.trim(t))&&r.push(t)}),r="["+(r=u.trim(r.join(" ")))+"]";var o=n.find('input[name="content"]').val();return(o=u.trim(o))&&(r+=" "+o+" [/"+e+"]"),r},cfredux.taggen.normalize=function(e){var t=e.val();e.is('input[name="name"]')&&(t=t.replace(/[^0-9a-zA-Z:._-]/g,"").replace(/^[^a-zA-Z]+/,"")),e.is(".numeric")&&(t=t.replace(/[^0-9.-]/g,"")),e.is(".idvalue")&&(t=t.replace(/[^-0-9a-zA-Z_]/g,"")),e.is(".classvalue")&&(t=u.map(t.split(" "),function(e){return e.replace(/[^-0-9a-zA-Z_]/g,"")}).join(" "),t=u.trim(t.replace(/\s+/g," "))),e.is(".color")&&(t=t.replace(/[^0-9a-fA-F]/g,"")),e.is(".filesize")&&(t=t.replace(/[^0-9kKmMbB]/g,"")),e.is(".filetype")&&(t=t.replace(/[^0-9a-zA-Z.,|\s]/g,"")),e.is(".date")&&(t.match(/^\d{4}-\d{2}-\d{2}$/)||(t="")),e.is('input[name="values"], textarea[name="values"]')&&(t=u.trim(t)),e.val(t),e.is('[type="checkbox"].exclusive')&&cfredux.taggen.exclusiveCheckbox(e)},cfredux.taggen.exclusiveCheckbox=function(e){!0===e.prop("checked")&&e.siblings('[type="checkbox"].exclusive').prop("checked",!1)},cfredux.taggen.insert=function(a){u("textarea#cfredux-form").each(function(){if(this.focus(),document.selection)document.selection.createRange().text=a;else if(this.selectionEnd||0===this.selectionEnd){var e=u(this).val(),t=this.selectionEnd;u(this).val(e.substring(0,t)+a+e.substring(t,e.length)),this.selectionStart=t+a.length,this.selectionEnd=t+a.length}else u(this).val(u(this).val()+a);this.focus()})})}(jQuery);