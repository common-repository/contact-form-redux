!function(d){"use strict";"undefined"!=typeof cfredux&&null!==cfredux&&(cfredux=d.extend({cached:0,inputs:[]},cfredux),d(function(){d("div.cfredux > form").each(function(){var e=d(this);cfredux.initForm(e),cfredux.cached&&cfredux.refill(e)})}),cfredux.getId=function(e){return parseInt(d('input[name="_cfredux"]',e).val(),10)},cfredux.initForm=function(e){var s=d(e);s.submit(function(e){"function"==typeof window.FormData&&(cfredux.submit(s),e.preventDefault())}),d(".cfredux-submit",s).after('<span class="ajax-loader"></span>'),cfredux.toggleSubmit(s),s.on("click",".cfredux-acceptance",function(){cfredux.toggleSubmit(s)}),d(".cfredux-exclusive-checkbox",s).on("click",'input[type="checkbox"]',function(){var e=d(this).attr("name");s.find('input[type="checkbox"][name="'+e+'"]').not(this).prop("checked",!1)}),d(".cfredux-list-item.has-free-text",s).each(function(){var e=d('input[type="text"].cfredux-free-text',this),t=d(this).closest(".cfredux-form-control");!0===d('[type="checkbox"], [type="radio"]',this).prop("checked")?e.prop("disabled",!1):e.prop("disabled",!0),t.on("change",'[type="checkbox"], [type="radio"]',function(){!0===d(".has-free-text",t).find('[type="checkbox"], [type="radio"]').prop("checked")?e.prop("disabled",!1).focus():e.prop("disabled",!0)})}),d(".cfredux-character-count",s).each(function(){function e(e){var e=d(e).val().length,t=r?n-e:e;a.attr("data-current-value",t),a.text(t),i&&i<e?a.addClass("too-long"):a.removeClass("too-long"),c&&e<c?a.addClass("too-short"):a.removeClass("too-short")}var a=d(this),t=a.attr("data-target-name"),r=a.hasClass("down"),n=parseInt(a.attr("data-starting-value"),10),i=parseInt(a.attr("data-maximum-value"),10),c=parseInt(a.attr("data-minimum-value"),10);d('input[name="'+t+'"], textarea[name="'+t+'"]',s).each(function(){e(this),d(this).keyup(function(){e(this)})})}),s.on("change",".cfredux-validates-as-url",function(){var e=d.trim(d(this).val());e&&!e.match(/^[a-z][a-z0-9.+-]*:/i)&&-1!==e.indexOf(".")&&(e="http://"+(e=e.replace(/^\/+/,""))),d(this).val(e)})},cfredux.submit=function(e){var r,c,n,t;"function"==typeof window.FormData&&(r=d(e),d(".ajax-loader",r).addClass("is-active"),cfredux.clearResponse(r),e=new FormData(r.get(0)),c={id:r.closest("div.cfredux").attr("id"),status:"init",inputs:[],formData:e},d.each(r.serializeArray(),function(e,t){var a;"_cfredux"==t.name?c.contactFormId=t.value:"_cfredux_version"==t.name?c.pluginVersion=t.value:"_cfredux_locale"==t.name?c.contactFormLocale=t.value:"_cfredux_unit_tag"==t.name?c.unitTag=t.value:"_cfredux_container_post"==t.name?c.containerPostId=t.value:t.name.match(/^_cfredux_\w+_free_text_/)?(a=t.name.replace(/^_cfredux_\w+_free_text_/,""),c.inputs.push({name:a+"-free-text",value:t.value})):t.name.match(/^_/)||c.inputs.push(t)}),t=Math.random().toString(20).substr(2,12),e.set("_cfredux_txn_id",t),cfredux.triggerEvent(r.closest("div.cfredux"),"beforesubmit",c),n=function(t,e,a,r){c.id=d(t.into).attr("id"),c.status=t.status,c.apiResponse=t;var n,i=d(".cfredux-response-output",r);switch(t.status){case"validation_failed":d.each(t.invalidFields,function(e,t){d(t.into,r).each(function(){cfredux.notValidTip(this,t.message),d(".cfredux-form-control",this).addClass("cfredux-not-valid"),d("[aria-invalid]",this).attr("aria-invalid","true")})}),i.addClass("cfredux-validation-errors"),r.addClass("invalid"),cfredux.triggerEvent(t.into,"invalid",c);break;case"acceptance_missing":i.addClass("cfredux-acceptance-missing"),r.addClass("unaccepted"),cfredux.triggerEvent(t.into,"unaccepted",c);break;case"spam":i.addClass("cfredux-spam-blocked"),r.addClass("spam"),d('[name="g-recaptcha-response"]',r).each(function(){var e;""===d(this).val()&&(e=d(this).closest(".cfredux-form-control-wrap"),cfredux.notValidTip(e,cfredux.recaptcha.messages.empty))}),cfredux.triggerEvent(t.into,"spam",c);break;case"aborted":i.addClass("cfredux-aborted"),r.addClass("aborted"),cfredux.triggerEvent(t.into,"aborted",c);break;case"mail_sent":i.addClass("cfredux-mail-sent-ok"),r.addClass("sent"),cfredux.triggerEvent(t.into,"mailsent",c);break;case"mail_failed":i.addClass("cfredux-mail-sent-ng"),r.addClass("failed"),cfredux.triggerEvent(t.into,"mailfailed",c);break;default:n="custom-"+t.status.replace(/[^0-9a-z]+/i,"-"),i.addClass("cfredux-"+n),r.addClass(n)}cfredux.refill(r,t),cfredux.triggerEvent(t.into,"submit",c),"mail_sent"==t.status&&(r.each(function(){this.reset()}),cfredux.toggleSubmit(r)),i.html("").append(t.message).slideDown("fast"),i.attr("role","alert"),d(".screen-reader-response",r.closest(".cfredux")).each(function(){var e=d(this),a=d("<ul></ul>");e.html("").attr("role","").append(t.message),t.invalidFields&&(d.each(t.invalidFields,function(e,t){t=t.idref?d("<li></li>").append(d("<a></a>").attr("href","#"+t.idref).append(t.message)):d("<li></li>").append(t.message);a.append(t)}),e.append(a)),e.attr("role","alert").focus()})},d.ajax({type:"POST",url:cfredux.apiSettings.getRoute("/contact-forms/"+cfredux.getId(r)+"/feedback"),data:e,dataType:"json",processData:!1,contentType:!1}).done(function(e,t,a){n(e,0,0,r),d(".ajax-loader",r).removeClass("is-active")}).fail(function(e,t,a){a=d('<div class="ajax-error"></div>').text(a.message);r.after(a)}))},cfredux.triggerEvent=function(e,t,a){var e=d(e),r=new CustomEvent("cfredux"+t,{bubbles:!0,detail:a});e.get(0).dispatchEvent(r),e.trigger("cfredux:"+t,a),e.trigger(t+".cfredux",a)},cfredux.toggleSubmit=function(e,t){var e=d(e),a=d('input[type="submit"]',e);void 0===t?e.hasClass("cfredux-acceptance-as-validation")||(a.prop("disabled",!1),d(".cfredux-acceptance",e).each(function(){var e=d(this),t=d('input[type="checkbox"]',e);if(!e.hasClass("optional")&&(e.hasClass("invert")&&!0===t.prop("checked")||!e.hasClass("invert")&&!1===t.prop("checked")))return a.prop("disabled",!0),!1})):a.prop("disabled",!t)},cfredux.notValidTip=function(e,t){e=d(e);d(".cfredux-not-valid-tip",e).remove(),d('<span role="alert" class="cfredux-not-valid-tip"></span>').text(t).appendTo(e)},cfredux.refill=function(e,t){var r=d(e),n=function(a,e){d.each(e,function(e,t){a.find('input[name="'+e+'"]').val(""),a.find('input[name="'+e+'"]').siblings("span.cfredux-quiz-label").text(t[0]),a.find('input[type="hidden"][name="_cfredux_quiz_answer_'+e+'"]').attr("value",t[1])})};void 0===t?d.ajax({type:"GET",url:cfredux.apiSettings.getRoute("/contact-forms/"+cfredux.getId(r)+"/refill"),beforeSend:function(e){var t=r.find('input[name="_wpnonce"]').val();t&&e.setRequestHeader("X-WP-Nonce",t)},dataType:"json"}).done(function(e,t,a){e.quiz&&n(r,e.quiz)}):t.quiz&&n(r,t.quiz)},cfredux.clearResponse=function(e){e=d(e);e.removeClass("invalid spam sent failed"),e.siblings(".screen-reader-response").html("").attr("role",""),d(".cfredux-not-valid-tip",e).remove(),d("[aria-invalid]",e).attr("aria-invalid","false"),d(".cfredux-form-control",e).removeClass("cfredux-not-valid"),d(".cfredux-response-output",e).hide().empty().removeAttr("role").removeClass("cfredux-mail-sent-ok cfredux-mail-sent-ng cfredux-validation-errors cfredux-spam-blocked")},cfredux.apiSettings.getRoute=function(e){return cfredux.apiSettings.root.replace(cfredux.apiSettings.namespace,cfredux.apiSettings.namespace+e)})}(jQuery),function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var a=document.createEvent("CustomEvent");return a.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),a}"function"!=typeof window.CustomEvent&&(e.prototype=window.Event.prototype,window.CustomEvent=e)}();